window.krpanoplugin=function(){var z=this,w=null,I=null,s=false,p,k=false,x=0.1,m=1,n=1,D=1,v=0.0001,H=1,J=1,h=1,G=1,A=95,j=0.002,l=0.001,C=1,c=1,o=0.01,B=0,K=function(){var M=[];for(var N=0;N<16;N++){M.push(999+parseInt(99999*Math.random(),10))}return M}(),e="idleViewStart",t="idleViewEnd",b=1.5,g,L=0.87,u=1/L,f=11,a=function(M){for(var N=0;N<f;N++){M.push(b)}return M}([]);z.registerplugin=function(O,M,P){w=O;I=P;if(w.version<"1.0.8.14"||w.build<"2011-03-30"){console.warn(3,"idleView plugin - too old krpano version (min. 1.0.8.14)");return}var N=w.get("xml").content.match(/\sfov="([0-9]*)"/);if(N.length>1){A=parseInt(N[1],10)}I.registerattribute("idletimeout",G,function(Q){G=Q},function(){return G});I.registerattribute("forceh",m,function(Q){m=Q},function(){return m});I.registerattribute("forcev",n,function(Q){n=Q},function(){return n});I.registerattribute("forcez",D,function(Q){D=Q},function(){return D});I.registerattribute("frequencyh",H,function(Q){H=Q},function(){return H});I.registerattribute("frequencyv",J,function(Q){J=Q},function(){return J});I.registerattribute("frequencyz",h,function(Q){h=Q},function(){return h});I.registerattribute("attractv",c,function(Q){c=Q},function(){return c});I.registerattribute("attractz",C,function(Q){C=Q},function(){return C});I.registerattribute("offseth",0,function(Q){B=Q},function(){return B});I.enable=i;I.disable=d;i()};z.unloadplugin=function(){r(false);I=null;w=null};function i(){r();q()}function d(){r(false);q()}function r(P){if(P===undefined){P=true}if(s!==P){var O=P?window.addEventListener:window.removeEventListener;var M=["mousemove","touchmove"];for(var N=0;N<M.length;N++){O(M[N],q)}s=P}}function q(){if(k){y(false)}if(p!==undefined){clearTimeout(p)}p=setTimeout(function(){y()},G)}function y(M){if(M===undefined){M=true}if(k!==M){k=M;k&&F();window.dispatchEvent(new CustomEvent(k?e:t))}}function F(){var P=Date.now(),M=P-g,R=Math.min(Math.max(!g?1:M/10,L*b),u*b);a.push(R);a.shift();b=0;for(var O=0;O<f;O++){b+=a[O]}b/=f;g=P;if(k){if(M<1000){var T="";if(m>0){var Q=m*x*(E.noise(K[0]+H*v*P,K[1])-0.5)+o*B;T+="set(hlookat_moveforce,"+b*Q+");"}if(n>0){var N=n*x*(E.noise(K[2]+J*v*P,K[3])-0.5);if(c>=0){N-=c*l*w.get("view.vlookat")}T+="set(vlookat_moveforce,"+b*N+");"}if(D>0){var S=D*x*(E.noise(K[4]+h*v*P,K[5])-0.5);if(C>=0){S-=C*j*(w.get("view.fov")-A)}T+="set(fov_moveforce,"+b*S+");"}if(T!==""){w.call(T)}}requestAnimFrame(F)}else{w.call("set(hlookat_moveforce,0);set(vlookat_moveforce,0);set(fov_moveforce,0);");g=null}}if(!window.hasOwnProperty("requestAnimFrame")){window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(M){window.setTimeout(M,1000/60)}})()}var E=(function(){var aj=0.5*(Math.sqrt(3)-1);var X=(3-Math.sqrt(3))/6;var az=2*X-1;var N=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]];var S;var ay;var ah,ag,af;var aq;var aw,av;var ap;var aa,M;var R,ax;var Z,aC;var Y,aB;var ak,U;var W,V,T;var am,al,ai;var O=Math;var ao=1;var an=0.5;var P,ac,at;var ae;var au;var ad;var Q=function Q(){var aD,aE;ae=[];au=[];ad=0;for(var aF=0;aF<ao;aF++){aD=Math.pow(2,aF);aE=Math.pow(an,aF);ad+=aE;ae.push(aD);au.push(aE)}ad=1/ad};var ar=function ar(aE,aD,aF){return aE[0]*aD+aE[1]*aF};var ab=function ab(){var aD;var aE=[];for(aD=0;aD<256;aD++){aE[aD]=Math.floor(O.random()*256)}S=[];for(aD=0;aD<512;aD++){S[aD]=aE[aD&255]}};var aA=function aA(aD,aE){aq=(aD+aE)*aj;aw=Math.floor(aD+aq);av=Math.floor(aE+aq);ap=(aw+av)*X;aa=aD-(aw-ap);M=aE-(av-ap);if(aa>M){R=1;ax=0}else{R=0;ax=1}Z=aa-R+X;aC=M-ax+X;Y=aa+az;aB=M+az;ak=aw&255;U=av&255;am=0.5-aa*aa-M*M;if(am<0){ah=0}else{am*=am;W=S[ak+S[U]]%12;ah=am*am*ar(N[W],aa,M)}al=0.5-Z*Z-aC*aC;if(al<0){ag=0}else{al*=al;V=S[ak+R+S[U+ax]]%12;ag=al*al*ar(N[V],Z,aC)}ai=0.5-Y*Y-aB*aB;if(ai<0){af=0}else{ai*=ai;T=S[ak+1+S[U+1]]%12;af=ai*ai*ar(N[T],Y,aB)}return 70*(ah+ag+af)};ab();Q();return{noise:function(aD,aE){P=0;for(ay=0;ay<ao;ay++){ac=ae[ay];at=au[ay];P+=at*aA(ac*aD,ac*aE)}return(P*ad+1)*0.5},noiseDetail:function(aD,aE){ao=aD||ao;an=aE||an;Q()},setRng:function(aD){O=aD;ab()},toString:function(){return"[object PerlinSimplex "+ao+" "+an+"]"}}})()};