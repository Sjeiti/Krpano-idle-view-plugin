window.krpanoplugin=function(){var A=null,L=null,s=false,p,k=false,B=0.1,m=1,n=1,G=1,z=0.0001,K=1,N=1,h=1,w=1,y=1,M=1,J=1,D=95,j=0.002,l=0.001,F=1,c=1,o=0.01,E=0,O=function(Q){for(var R=0;R<16;R++){Q.push(999+parseInt(99999*Math.random(),10))}return Q}([]),v="idleViewInitialized",e="idleViewStart",t="idleViewEnd",b=1.5,g,P=0.87,x=1/P,f=11,a=function(Q){for(var R=0;R<f;R++){Q.push(b)}return Q}([]);this.registerplugin=function(T,R,U){delete window.krpanoplugin;A=T;L=U;if(A.version<"1.0.8.14"||A.build<"2011-03-30"){console.warn(3,"idleView plugin - too old krpano version (min. 1.0.8.14)");return}var Q=A.get("xml").content;var S=Q&&Q.match(/\sfov="([0-9]*)"/);if(S&&S.length>1){D=parseInt(S[1],10)}L.registerattribute("idletimeout",J,function(V){J=V},function(){return J});L.registerattribute("forceh",m,function(V){m=V},function(){return m});L.registerattribute("forcev",n,function(V){n=V},function(){return n});L.registerattribute("forcez",G,function(V){G=V},function(){return G});L.registerattribute("frequencyh",K,function(V){K=V},function(){return K});L.registerattribute("frequencyv",N,function(V){N=V},function(){return N});L.registerattribute("frequencyz",h,function(V){h=V},function(){return h});L.registerattribute("gammah",w,function(V){w=V},function(){return w});L.registerattribute("gammav",y,function(V){y=V},function(){return y});L.registerattribute("gammaz",M,function(V){M=V},function(){return M});L.registerattribute("attractv",c,function(V){c=V},function(){return c});L.registerattribute("attractz",F,function(V){F=V},function(){return F});L.registerattribute("offseth",0,function(V){E=V},function(){return E});L.enable=i;L.disable=d;i();L.toString=function(){return"[object krpano idle view plugin]"};window.dispatchEvent(new CustomEvent(v,{detail:L}))};this.unloadplugin=function(){r(false);L=null;A=null};function i(){r();q()}function d(){r(false);q()}function r(T){if(T===undefined){T=true}if(s!==T){var S=T?window.addEventListener:window.removeEventListener;var Q=["mousemove","touchmove"];for(var R=0;R<Q.length;R++){S(Q[R],q)}s=T}}function q(){if(k){C(false)}if(p!==undefined){clearTimeout(p)}p=setTimeout(function(){C()},J)}function C(Q){if(Q===undefined){Q=true}if(k!==Q){k=Q;k&&I();window.dispatchEvent(new CustomEvent(k?e:t))}}function u(S,R){var T=S<0,Q;if(T){S=-S}Q=Math.pow(S,R);return T?-Q:Q}function I(){var S=Date.now(),Q=S-g,V=Math.min(Math.max(!g?1:Q/10,P*b),x*b);a.push(V);a.shift();b=0;for(var R=0;R<f;R++){b+=a[R]}b/=f;g=S;if(k){if(Q<1000){var W="",U,T;if(m>0){U=H.noise(O[0]+K*z*S,O[1])-0.5;if(w!==1){U=u(U,w)}T=m*B*U+o*E;W+="set(hlookat_moveforce,"+b*T+");"}if(n>0){U=H.noise(O[2]+N*z*S,O[3])-0.5;if(y!==1){U=u(U,y)}T=n*B*U;if(c>=0){T-=c*l*A.get("view.vlookat")}W+="set(vlookat_moveforce,"+b*T+");"}if(G>0){U=H.noise(O[4]+h*z*S,O[5])-0.5;if(M!==1){U=u(U,M)}T=G*B*U;if(F>=0){T-=F*j*(A.get("view.fov")-D)}W+="set(fov_moveforce,"+b*T+");"}if(W!==""){A.call(W)}}requestAnimFrame(I)}else{A.call("set(hlookat_moveforce,0);set(vlookat_moveforce,0);set(fov_moveforce,0);");g=null}}if(!window.hasOwnProperty("requestAnimFrame")){window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(Q){window.setTimeout(Q,1000/60)}})()}var H=(function(){var an=0.5*(Math.sqrt(3)-1);var ab=(3-Math.sqrt(3))/6;var aD=2*ab-1;var R=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]];var W;var aC;var al,ak,aj;var av;var aA,az;var au;var ae,Q;var V,aB;var ad,aG;var ac,aF;var ao,Y;var aa,Z,X;var aq,ap,am;var S=Math;var at=1;var ar=0.5;var T,ag,ax;var ai;var ay;var ah;var U=function U(){var aH,aI;ai=[];ay=[];ah=0;for(var aJ=0;aJ<at;aJ++){aH=Math.pow(2,aJ);aI=Math.pow(ar,aJ);ah+=aI;ai.push(aH);ay.push(aI)}ah=1/ah};var aw=function aw(aI,aH,aJ){return aI[0]*aH+aI[1]*aJ};var af=function af(){var aH;var aI=[];for(aH=0;aH<256;aH++){aI[aH]=Math.floor(S.random()*256)}W=[];for(aH=0;aH<512;aH++){W[aH]=aI[aH&255]}};var aE=function aE(aH,aI){av=(aH+aI)*an;aA=Math.floor(aH+av);az=Math.floor(aI+av);au=(aA+az)*ab;ae=aH-(aA-au);Q=aI-(az-au);if(ae>Q){V=1;aB=0}else{V=0;aB=1}ad=ae-V+ab;aG=Q-aB+ab;ac=ae+aD;aF=Q+aD;ao=aA&255;Y=az&255;aq=0.5-ae*ae-Q*Q;if(aq<0){al=0}else{aq*=aq;aa=W[ao+W[Y]]%12;al=aq*aq*aw(R[aa],ae,Q)}ap=0.5-ad*ad-aG*aG;if(ap<0){ak=0}else{ap*=ap;Z=W[ao+V+W[Y+aB]]%12;ak=ap*ap*aw(R[Z],ad,aG)}am=0.5-ac*ac-aF*aF;if(am<0){aj=0}else{am*=am;X=W[ao+1+W[Y+1]]%12;aj=am*am*aw(R[X],ac,aF)}return 70*(al+ak+aj)};af();U();return{noise:function(aH,aI){T=0;for(aC=0;aC<at;aC++){ag=ai[aC];ax=ay[aC];T+=ax*aE(ag*aH,ag*aI)}return(T*ah+1)*0.5},noiseDetail:function(aH,aI){at=aH||at;ar=aI||ar;U()},setRng:function(aH){S=aH;af()},toString:function(){return"[object PerlinSimplex "+at+" "+ar+"]"}}})()};