window.krpanoplugin=function(){var A=null,M=null,s=false,p,k=false,B=0.1,m=1,n=1,H=1,z=0.0001,L=1,O=1,h=1,w=1,y=1,N=1,K=1,D=95,j=0.002,l=0.001,G=1,c=1,o=0.01,F=0,P=function(R){for(var S=0;S<16;S++){R.push(999+parseInt(99999*Math.random(),10))}return R}([]),v="idleViewInitialized",e="idleViewStart",t="idleViewEnd",b=1.5,g,Q=0.87,x=1/Q,f=11,a=function(R){for(var S=0;S<f;S++){R.push(b)}return R}([]);this.registerplugin=function(U,S,V){delete window.krpanoplugin;A=U;M=V;if(A.version<"1.0.8.14"||A.build<"2011-03-30"){console.warn(3,"idleView plugin - too old krpano version (min. 1.0.8.14)");return}var R=A.get("xml").content;var T=R&&R.match(/\sfov="([0-9]*)"/);if(T&&T.length>1){D=parseInt(T[1],10)}M.registerattribute("idletimeout",K,function(W){K=W},function(){return K});M.registerattribute("forceh",m,function(W){m=W},function(){return m});M.registerattribute("forcev",n,function(W){n=W},function(){return n});M.registerattribute("forcez",H,function(W){H=W},function(){return H});M.registerattribute("frequencyh",L,function(W){L=W},function(){return L});M.registerattribute("frequencyv",O,function(W){O=W},function(){return O});M.registerattribute("frequencyz",h,function(W){h=W},function(){return h});M.registerattribute("gammah",w,function(W){w=W},function(){return w});M.registerattribute("gammav",y,function(W){y=W},function(){return y});M.registerattribute("gammaz",N,function(W){N=W},function(){return N});M.registerattribute("attractv",c,function(W){c=W},function(){return c});M.registerattribute("attractz",G,function(W){G=W},function(){return G});M.registerattribute("offseth",0,function(W){F=W},function(){return F});M.enable=i;M.disable=d;i();M.toString=function(){return"[object krpano idle view plugin]"};E(window,v,M)};this.unloadplugin=function(){r(false);M=null;A=null};function i(){r();q()}function d(){r(false);q()}function E(U,T,S){var R=document.createEvent("CustomEvent");R.initCustomEvent(T,false,false,S);return U.dispatchEvent(R)}function r(U){if(U===undefined){U=true}if(s!==U){var T=U?window.addEventListener:window.removeEventListener;var R=["mousemove","touchmove"];for(var S=0;S<R.length;S++){T(R[S],q)}s=U}}function q(){if(k){C(false)}if(p!==undefined){clearTimeout(p)}p=setTimeout(function(){C()},K)}function C(R){if(R===undefined){R=true}if(k!==R){k=R;k&&J();E(window,k?e:t,M)}}function u(T,S){var U=T<0,R;if(U){T=-T}R=Math.pow(T,S);return U?-R:R}function J(){var T=Date.now(),R=T-g,W=Math.min(Math.max(!g?1:R/10,Q*b),x*b);a.push(W);a.shift();b=0;for(var S=0;S<f;S++){b+=a[S]}b/=f;g=T;if(k){if(R<1000){var X="",V,U;if(m>0){V=I.noise(P[0]+L*z*T,P[1])-0.5;if(w!==1){V=u(V,w)}U=m*B*V+o*F;X+="set(hlookat_moveforce,"+b*U+");"}if(n>0){V=I.noise(P[2]+O*z*T,P[3])-0.5;if(y!==1){V=u(V,y)}U=n*B*V;if(c>=0){U-=c*l*A.get("view.vlookat")}X+="set(vlookat_moveforce,"+b*U+");"}if(H>0){V=I.noise(P[4]+h*z*T,P[5])-0.5;if(N!==1){V=u(V,N)}U=H*B*V;if(G>=0){U-=G*j*(A.get("view.fov")-D)}X+="set(fov_moveforce,"+b*U+");"}if(X!==""){A.call(X)}}requestAnimFrame(J)}else{A.call("set(hlookat_moveforce,0);set(vlookat_moveforce,0);set(fov_moveforce,0);");g=null}}if(!window.hasOwnProperty("requestAnimFrame")){window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(R){window.setTimeout(R,1000/60)}})()}var I=(function(){var ao=0.5*(Math.sqrt(3)-1);var ac=(3-Math.sqrt(3))/6;var aE=2*ac-1;var S=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]];var X;var aD;var am,al,ak;var aw;var aB,aA;var av;var af,R;var W,aC;var ae,aH;var ad,aG;var ap,Z;var ab,aa,Y;var ar,aq,an;var T=Math;var au=1;var at=0.5;var U,ah,ay;var aj;var az;var ai;var V=function V(){var aI,aJ;aj=[];az=[];ai=0;for(var aK=0;aK<au;aK++){aI=Math.pow(2,aK);aJ=Math.pow(at,aK);ai+=aJ;aj.push(aI);az.push(aJ)}ai=1/ai};var ax=function ax(aJ,aI,aK){return aJ[0]*aI+aJ[1]*aK};var ag=function ag(){var aI;var aJ=[];for(aI=0;aI<256;aI++){aJ[aI]=Math.floor(T.random()*256)}X=[];for(aI=0;aI<512;aI++){X[aI]=aJ[aI&255]}};var aF=function aF(aI,aJ){aw=(aI+aJ)*ao;aB=Math.floor(aI+aw);aA=Math.floor(aJ+aw);av=(aB+aA)*ac;af=aI-(aB-av);R=aJ-(aA-av);if(af>R){W=1;aC=0}else{W=0;aC=1}ae=af-W+ac;aH=R-aC+ac;ad=af+aE;aG=R+aE;ap=aB&255;Z=aA&255;ar=0.5-af*af-R*R;if(ar<0){am=0}else{ar*=ar;ab=X[ap+X[Z]]%12;am=ar*ar*ax(S[ab],af,R)}aq=0.5-ae*ae-aH*aH;if(aq<0){al=0}else{aq*=aq;aa=X[ap+W+X[Z+aC]]%12;al=aq*aq*ax(S[aa],ae,aH)}an=0.5-ad*ad-aG*aG;if(an<0){ak=0}else{an*=an;Y=X[ap+1+X[Z+1]]%12;ak=an*an*ax(S[Y],ad,aG)}return 70*(am+al+ak)};ag();V();return{noise:function(aI,aJ){U=0;for(aD=0;aD<au;aD++){ah=aj[aD];ay=az[aD];U+=ay*aF(ah*aI,ah*aJ)}return(U*ai+1)*0.5},noiseDetail:function(aI,aJ){au=aI||au;at=aJ||at;V()},setRng:function(aI){T=aI;ag()},toString:function(){return"[object PerlinSimplex "+au+" "+at+"]"}}})()};